---
title: "Oregon Birth Data"
author: "Antonio Ceniceros"
date: "`r Sys.Date()`"
output:
  pdf_document:
    fig_width: 7
    fig_height: 4
geometry: margin = 0.75in
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = FALSE, warning = FALSE, message = FALSE, fig.align = 'center')

require(pacman)

p_load(
  tidyverse,
  dplyr,
  ggplot2,
  here,
  janitor,
  readr,
  knitr,
  scales
)

```

# Summary

## *Research question: Is there health disparities in birth outcomes among American Indian/Alaskan Native populations vs other racial groups in the state of Oregon.*

This analysis examines birth outcomes across different racial groups in Oregon, focusing on low birth weight rates and prenatal care utilization. Using population-level health data, we identified significant disparities in birth outcomes and explored the relationship between prenatal care timing and birth weight.


```{r load data}

df <- read.csv(here("births_data.csv")) |> 
  clean_names() |> 
  na.omit() |> 
  rename(
    race = mother_s_single_race,
    hispanic_origin = mother_s_hispanic_origin,
    infant_birth_weight = infant_birth_weight_12,
    month_prenatal = month_prenatal_care_began
  ) |> 
  select(
    race,
    hispanic_origin,
    infant_birth_weight,
    month_prenatal,
    births
  ) |> 
  mutate(
    month_prenatal = parse_number(month_prenatal),
    low_birth_weight = case_when(
      infant_birth_weight %in% c(
        "499 grams or less",
        "500 - 999 grams",
        "1000 - 1499 grams",
        "1500 - 1999 grams",
        "2000 - 2499 grams"
      ) ~ "Low birth weight",
      TRUE ~ "Normal birth weight"
    )
  )

```

## *Key Findings*

**Summary stats**: People who identify as White are the majority of total births (85%) while American Indian/Alaskan Native accounted for 1.7%

```{r summary stats}

# Calculate key summary statistics
race_distribution <- df %>%
  group_by(race) %>%
  summarise(
    total_births = sum(births),
    n_records = n()
  ) %>%
  mutate(percentage = (total_births / sum(total_births)) * 100) %>%
  arrange(desc(total_births))

lbw_by_race <- df %>%
  group_by(race, low_birth_weight) %>%
  summarise(total = sum(births), .groups = "drop") %>%
  group_by(race) %>%
  mutate(percentage = (total / sum(total)) * 100) %>%
  filter(low_birth_weight != "Normal birth weight") %>%
  arrange(desc(percentage))

# Compare birth weight distributions across races
weight_dist <- df |>
  group_by(race, low_birth_weight) |>
  summarise(total = sum(births), .groups = "drop") |>
  group_by(race) |>
  mutate(percentage = (total / sum(total)) * 100)

# Low birth weight rates by Hispanic origin
lbw_by_hispanic <- df |>
  group_by(hispanic_origin, low_birth_weight) |>
  summarise(total = sum(births)) |>
  group_by(hispanic_origin) |>
  mutate(percentage = (total / sum(total)) * 100) |>
  filter(low_birth_weight != "Normal birth weight")

# Does earlier prenatal care reduce low birth weight?
care_timing_effect <- df |>
  group_by(race, month_prenatal, low_birth_weight) |>
  summarise(total = sum(births)) |>
  group_by(month_prenatal) |>
  mutate(percentage = (total / sum(total)) * 100) |>
  filter(low_birth_weight != "Normal birth weight")

# Display summary table
kable(race_distribution, 
      col.names = c("Race", "Total Births", "Records", "% of Total"),
      digits = 1,
      caption = "Birth Distribution by Race")


```

**Statisical Analysis**: A chi-square test of independence revealed a statistically significant association between race and low birth weight status (p < 0.001), indicating that birth weight outcomes vary significantly across racial groups. In the contingency table, there is a value of 0, but none with expected value <5. 


### *Chi square*
```{r chi square, fig.width=3.0}

# Aggregate the data first
agg_data <- df |>
  group_by(race, low_birth_weight) |>
  summarise(total = sum(births), .groups = "drop")

# Create contingency table using xtabs
cont_table <- xtabs(total ~ race + low_birth_weight, data = agg_data)

chisq_result <- chisq.test(cont_table)

# Format the contingency table
kable(cont_table, 
      caption = "Contingency Table: Race by Low Birth Weight Status",
      booktabs = TRUE)

# Format chi-square results
chi_results <- data.frame(
  Statistic = c("Chi-square", "Degrees of Freedom", "P-value"),
  Value = c(
    round(chisq_result$statistic, 2),
    chisq_result$parameter,
    ifelse(chisq_result$p.value < 0.001, "< 0.001", 
           round(chisq_result$p.value, 4))
  )
)

kable(chi_results, 
      col.names = c("Test Statistic", "Value"),
      caption = "Chi-Square Test Results",
      booktabs = TRUE)


```

### *Analysis*
```{r analysis & plots, fig.height=3.5}

# Convert to factor with correct order
lbw_by_race <- lbw_by_race |>
  mutate(race_formatted = str_replace(race, " or ", "\nor "))

# Visualize
ggplot(lbw_by_race, aes(x = reorder(race_formatted, -percentage), y = percentage)) +
  geom_bar(stat = "identity", fill = "#d95f02", alpha = 0.8) +
  ylim(0, 8) +
  geom_text(aes(label = sprintf("%.1f%%", percentage)), vjust = -0.5, size = 3) +
  labs(title = "Low Birth Weight Rates by Race in Oregon, 2018-2022",
       x = "",
       y = "Percentage (%)",
       caption = "Source: CDC Wonder") +
  theme_minimal() +
  theme(axis.text.x = element_text(angle = 45, hjust = 1))


# Convert to factor with correct order
weight_dist <- weight_dist |>
  mutate(low_birth_weight = factor(low_birth_weight),
         # Add line breaks to long race names
         race_formatted = str_replace(race, " or ", "\nor "))

# Stacked bar chart
ggplot(weight_dist, aes(x = race_formatted, y = percentage, fill = low_birth_weight)) +
  geom_bar(stat = "identity", alpha = 0.8) +
  labs(title = "Birth Weight Distribution by Race in Oregon, 2018-2022",
       x = "",
       y = "Percentage (%)",
       caption = "Source: CDC Wonder") +
  theme_minimal() +
  theme(axis.text.x = element_text(angle = 45, hjust = 1, size = 10))

```

## Limitations

This analysis has several important limitations:

1. **Geographic Scope**: Data were originally requested for Klamath County; however, due to CDC WONDER's data suppression rules for small populations, this analysis utilized statewide Oregon data. This geographic aggregation may mask important county-level variations and limits the applicability of findings to Klamath County specifically.

2. **Ecological Fallacy**: Population-level associations cannot be used to infer individual-level relationships. Observed disparities do not account for individual confounders.

3. **Unmeasured Confounding**: Important factors such as maternal education, income, insurance status, healthcare access, maternal age, and pre-existing conditions are not included in this analysis.

4. **Data Suppression**: CDC WONDER suppresses data for privacy protection, potentially resulting in incomplete representation of smaller racial/ethnic populations, particularly affecting American Indian/Alaska Native populations.

5. **Prenatal Care Measurement**: Analysis captures only timing of care initiation, not quality, frequency, or content of prenatal services received.

6. **Race/Ethnicity Classification**: Self-reported categories may not capture the full complexity of identity and within-group heterogeneity. For Native American populations specifically, this classification does not account for tribal affiliation, urban versus reservation residence, or degree of connection to traditional healthcare systems.

## Conclusions

This statewide analysis of Oregon birth outcomes reveals significant racial disparities in birth outcomes. The findings suggest that:

1. Low birth weight rates vary significantly across racial groups (p < 0.001)
2. Birth weight distributions differ substantially across populations

While statewide data provide important insights into population-level health disparities, the inability to access county-specific data limits conclusions about Klamath County specifically. The geographic aggregation is particularly problematic for understanding American Indian/Alaska Native birth outcomes, as these populations may have unique health service utilization patterns and risk factors that vary by tribal affiliation and geographic location.

**Recommendations for Future Research:**

To better understand birth outcome disparities, particularly for Native American populations, future studies should: (1) partner with Tribal Health Organizations and Tribal Epidemiology Centers for more detailed community-specific data; (2) incorporate cultural factors and assess specific healthcare access barriers including geographic isolation, transportation, and culturally competent care availability; (3) examine differences between urban and reservation populations; and (4) employ Community-Based Participatory Research approaches that center Native voices and ensure findings benefit the communities studied. These approaches would provide more nuanced understanding and inform targeted, culturally appropriate interventions.

---

**Methods**: Data were analyzed using R (version 4.2.1). Statistical significance was assessed using chi-square tests. All visualizations created using ggplot2.

**Code**: Full code can be found at this link: https://github.com/tonioceniceros/birth_data/blob/main/births_data.Rmd
